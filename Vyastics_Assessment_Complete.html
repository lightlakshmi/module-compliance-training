<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vyastics - Compliance Training Assessment 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #065A82 0%, #1C7293 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #21295C 0%, #065A82 100%);
            color: white;
            padding: 35px;
            text-align: center;
        }
        
        .company-name {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 12px;
        }
        
        .header p {
            font-size: 17px;
            opacity: 0.95;
        }
        
        .module-badges {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .badge {
            background: rgba(255,255,255,0.2);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
            animation: fadeIn 0.4s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .loading {
            text-align: center;
            padding: 60px;
            font-size: 18px;
            color: #666;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1C7293;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .module-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 35px;
        }
        
        .module-card {
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .module-card:hover {
            border-color: #1C7293;
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(28,114,147,0.2);
        }
        
        .module-card.selected {
            border-color: #1C7293;
            background: linear-gradient(135deg, #E8F4F8 0%, #D4EDF6 100%);
        }
        
        .module-icon {
            font-size: 42px;
            margin-bottom: 12px;
        }
        
        .module-title {
            font-size: 18px;
            font-weight: 700;
            color: #21295C;
            margin-bottom: 8px;
        }
        
        .module-desc {
            font-size: 13px;
            color: #666;
        }
        
        .form-group {
            margin-bottom: 22px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
            font-size: 15px;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 13px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #1C7293;
        }
        
        .question-card {
            background: #f9fafb;
            border-left: 5px solid #1C7293;
            padding: 28px;
            margin-bottom: 28px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .question-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 14px;
            color: #666;
        }
        
        .question-number {
            font-weight: 700;
            color: #1C7293;
        }
        
        .module-tag {
            background: #E8F4F8;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            color: #065A82;
        }
        
        .question-text {
            font-size: 19px;
            color: #222;
            margin-bottom: 18px;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .options {
            margin-left: 10px;
        }
        
        .option {
            margin-bottom: 14px;
        }
        
        .option input[type="radio"] {
            margin-right: 12px;
            cursor: pointer;
            transform: scale(1.2);
        }
        
        .option label {
            cursor: pointer;
            font-size: 16px;
            color: #444;
            line-height: 1.5;
        }
        
        .option:hover label {
            color: #1C7293;
        }
        
        .btn {
            background: linear-gradient(135deg, #1C7293 0%, #065A82 100%);
            color: white;
            border: none;
            padding: 16px 35px;
            font-size: 17px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(28,114,147,0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(28,114,147,0.4);
        }
        
        .btn:disabled {
            background: #bbb;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #6c757d;
            margin-left: 12px;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            background: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 8px;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #1C7293 0%, #02C39A 100%);
            height: 100%;
            transition: width 0.4s ease;
        }
        
        .progress-text {
            text-align: center;
            font-size: 14px;
            color: #666;
            font-weight: 600;
        }
        
        .result-card {
            text-align: center;
            padding: 45px;
        }
        
        .result-card.pass {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }
        
        .result-card.fail {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }
        
        .result-icon {
            font-size: 90px;
            margin-bottom: 22px;
        }
        
        .result-title {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 18px;
            color: #21295C;
        }
        
        .result-score {
            font-size: 56px;
            font-weight: bold;
            margin: 25px 0;
            color: #065A82;
        }
        
        .result-message {
            font-size: 18px;
            line-height: 1.7;
            margin-bottom: 22px;
            color: #444;
        }
        
        .alert {
            padding: 16px;
            margin-bottom: 22px;
            border-radius: 8px;
            font-size: 15px;
            line-height: 1.6;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }
        
        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .module-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }
        
        .module-score-card {
            background: white;
            padding: 18px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            text-align: center;
        }
        
        .module-score-card h4 {
            font-size: 15px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .module-score-card .score {
            font-size: 28px;
            font-weight: bold;
            color: #21295C;
        }
        
        @media (max-width: 768px) {
            .content {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .company-name {
                font-size: 32px;
            }
            
            .module-selector {
                grid-template-columns: 1fr;
            }
            
            .question-text {
                font-size: 17px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="company-name">VYASTICS</div>
            <h1>üéì Compliance Training Assessment 2026</h1>
            <p>Code of Conduct ‚Ä¢ Data Privacy ‚Ä¢ ISMS ‚Ä¢ POSH</p>
            <div class="module-badges">
                <span class="badge">20 Questions Per Module</span>
                <span class="badge">80% Pass Required</span>
                <span class="badge">Unlimited Retakes</span>
            </div>
        </div>
        
        <div class="content">
            <!-- Section 1: Module Selection & User Info -->
            <div id="setupSection" class="section active">
                <h2 style="margin-bottom: 25px; color: #21295C;">Step 1: Select Training Module</h2>
                
                <div class="alert alert-info">
                    <strong>üìã Assessment Rules:</strong> You must score 80% or higher to pass (16/20 correct). Each module has 20 questions (10 easy, 5 medium, 5 hard) selected randomly. Retakes allowed. All attempts tracked.
                </div>
                
                <div class="module-selector">
                    <div class="module-card" data-module="code-conduct">
                        <div class="module-icon">üìú</div>
                        <div class="module-title">Code of Conduct</div>
                        <div class="module-desc">Ethics, AI, Digital Workplace</div>
                    </div>
                    
                    <div class="module-card" data-module="data-privacy">
                        <div class="module-icon">üîí</div>
                        <div class="module-title">Data Privacy</div>
                        <div class="module-desc">GDPR + India DPDP Act</div>
                    </div>
                    
                    <div class="module-card" data-module="isms">
                        <div class="module-icon">üõ°Ô∏è</div>
                        <div class="module-title">ISMS Security</div>
                        <div class="module-desc">ISO 27001, Zero Trust</div>
                    </div>
                    
                    <div class="module-card" data-module="posh">
                        <div class="module-icon">ü§ù</div>
                        <div class="module-title">POSH</div>
                        <div class="module-desc">Sexual Harassment Prevention</div>
                    </div>
                </div>
                
                <h2 style="margin: 35px 0 25px; color: #21295C;">Step 2: Your Information</h2>
                
                <div class="form-group">
                    <label for="employeeName">Full Name *</label>
                    <input type="text" id="employeeName" required placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="employeeId">Employee ID *</label>
                    <input type="text" id="employeeId" required placeholder="Enter your employee ID">
                </div>
                
                <div class="form-group">
                    <label for="department">Department *</label>
                    <select id="department" required>
                        <option value="">Select Department</option>
                        <option value="Administration">Administration</option>
                        <option value="Finance">Finance</option>
                        <option value="Human Resources">Human Resources</option>
                        <option value="Operations">Operations</option>
                        <option value="Sales & Marketing">Sales & Marketing</option>
                        <option value="IT">Information Technology</option>
                        <option value="Customer Service">Customer Service</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Quality Assurance">Quality Assurance</option>
                        <option value="Legal & Compliance">Legal & Compliance</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" required placeholder="[email protected]">
                </div>
                
                <button class="btn" onclick="startAssessment()">Start Assessment ‚Üí</button>
            </div>
            
            <!-- Section 2: Assessment Questions -->
            <div id="assessmentSection" class="section">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">Question 1 of 20</div>
                </div>
                
                <div id="questionContainer"></div>
                
                <div style="margin-top: 35px; display: flex; justify-content: space-between; align-items: center;">
                    <button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn" style="display: none;">‚Üê Previous</button>
                    <div style="flex: 1;"></div>
                    <button class="btn" onclick="nextQuestion()" id="nextBtn">Next ‚Üí</button>
                    <button class="btn" onclick="submitAssessment()" id="submitBtn" style="display: none;">Submit Assessment</button>
                </div>
            </div>
            
            <!-- Section 3: Results -->
            <div id="resultsSection" class="section">
                <div id="resultContent"></div>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURATION
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwN3_xce7ZJ7TGWHtoUaBeVXlXMoyQ_BBcGrS712u_aQ4x17KISurKodByTYTZNO90-mg/exec";
        
        let selectedModule = null;
        let currentQuestion = 0;
        let userAnswers = [];
        let userData = {};
        let questionsPool = [];
        
        // Module selection (SINGLE MODULE ONLY)
        document.querySelectorAll('.module-card').forEach(card => {
            card.addEventListener('click', function() {
                // Deselect all others
                document.querySelectorAll('.module-card').forEach(c => c.classList.remove('selected'));
                
                // Select this one
                this.classList.add('selected');
                selectedModule = this.dataset.module;
            });
        });

        async function startAssessment() {
            const name = document.getElementById('employeeName').value.trim();
            const empId = document.getElementById('employeeId').value.trim();
            const dept = document.getElementById('department').value;
            const email = document.getElementById('email').value.trim();

            if (!name || !empId || !dept || !email) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (!selectedModule) {
                alert('Please select a training module');
                return;
            }

            userData = {
                name,
                employeeId: empId,
                department: dept,
                email,
                module: selectedModule,
                timestamp: new Date().toISOString()
            };

            // Show loading
            showSection('assessmentSection');
            document.getElementById('questionContainer').innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading questions from Google Sheets...</p>
                    <p style="font-size: 14px; color: #999; margin-top: 10px;">Selecting 10 easy, 5 medium, 5 hard questions randomly</p>
                </div>
            `;

            try {
                // Load questions from Google Sheets
                const response = await fetch(`${SCRIPT_URL}?action=getQuestions&module=${selectedModule}`);
                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }
                
                questionsPool = data;
                
                if (questionsPool.length !== 20) {
                    throw new Error(`Expected 20 questions, got ${questionsPool.length}`);
                }
                
                currentQuestion = 0;
                userAnswers = new Array(20).fill(undefined);
                
                displayQuestion();
                
            } catch (error) {
                console.error('Error loading questions:', error);
                document.getElementById('questionContainer').innerHTML = `
                    <div class="alert alert-danger">
                        <strong>‚ùå Error Loading Questions:</strong><br>
                        ${error.message}<br><br>
                        <strong>Possible Issues:</strong><br>
                        ‚Ä¢ Google Apps Script not deployed<br>
                        ‚Ä¢ Question bank doesn't have enough questions<br>
                        ‚Ä¢ Network connection issue<br><br>
                        <button class="btn" onclick="location.reload()">Try Again</button>
                    </div>
                `;
            }
        }

        function displayQuestion() {
            const question = questionsPool[currentQuestion];
            const container = document.getElementById('questionContainer');
            
            const moduleNames = {
                'code-conduct': 'Code of Conduct',
                'data-privacy': 'Data Privacy',
                'isms': 'ISMS Security',
                'posh': 'POSH'
            };
            
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-meta">
                        <span class="question-number">Question ${currentQuestion + 1} of 20</span>
                        <span class="module-tag">${moduleNames[selectedModule]}</span>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option">
                                <input type="radio" 
                                       id="option${index}" 
                                       name="question${currentQuestion}" 
                                       value="${index}"
                                       ${userAnswers[currentQuestion] === index ? 'checked' : ''}>
                                <label for="option${index}">${option}</label>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            updateProgress();
            updateButtons();
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / 20) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of 20`;
        }

        function updateButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');

            prevBtn.style.display = currentQuestion > 0 ? 'inline-block' : 'none';
            
            if (currentQuestion === 19) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';
            }
        }

        function saveCurrentAnswer() {
            const selected = document.querySelector(`input[name="question${currentQuestion}"]:checked`);
            if (selected) {
                userAnswers[currentQuestion] = parseInt(selected.value);
            }
        }

        function nextQuestion() {
            saveCurrentAnswer();
            
            if (currentQuestion < 19) {
                currentQuestion++;
                displayQuestion();
            }
        }

        function previousQuestion() {
            saveCurrentAnswer();
            
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }

        async function submitAssessment() {
            saveCurrentAnswer();

            if (userAnswers.includes(undefined)) {
                alert('Please answer all 20 questions before submitting.');
                return;
            }

            // Calculate score
            let totalCorrect = 0;
            
            questionsPool.forEach((question, index) => {
                if (userAnswers[index] === question.correct) {
                    totalCorrect++;
                }
            });

            const totalScore = Math.round((totalCorrect / 20) * 100);
            const passed = totalScore >= 80;

            // Get attempt number
            const allAttempts = JSON.parse(localStorage.getItem('complianceAttempts') || '[]');
            const attemptNumber = allAttempts.filter(a => a.employeeId === userData.employeeId && a.module === selectedModule).length + 1;

            // Save to Google Sheets
            try {
                const payload = {
                    employeeId: userData.employeeId,
                    name: userData.name,
                    department: userData.department,
                    email: userData.email,
                    module: selectedModule,
                    score: totalScore,
                    status: passed ? "PASS" : "FAIL",
                    attempt: attemptNumber,
                    date: new Date().toLocaleString()
                };

                await fetch(SCRIPT_URL, {
                    method: "POST",
                    body: JSON.stringify(payload),
                    headers: { "Content-Type": "application/json" }
                });
                
                console.log("‚úÖ Results saved to Google Sheets");
            } catch (error) {
                console.error("‚ùå Error saving to Google Sheets:", error);
            }

            // Save to localStorage as backup
            const attemptData = {
                ...userData,
                score: totalScore,
                correctAnswers: totalCorrect,
                totalQuestions: 20,
                passed: passed,
                attempt: attemptNumber,
                timestamp: new Date().toISOString()
            };
            
            allAttempts.push(attemptData);
            localStorage.setItem('complianceAttempts', JSON.stringify(allAttempts));

            displayResults(totalScore, totalCorrect, passed, attemptNumber);
        }

        function displayResults(score, correctAnswers, passed, attemptNumber) {
            const resultContent = document.getElementById('resultContent');
            
            const moduleNames = {
                'code-conduct': 'Code of Conduct',
                'data-privacy': 'Data Privacy',
                'isms': 'ISMS Security',
                'posh': 'POSH'
            };
            
            resultContent.innerHTML = `
                <div class="result-card ${passed ? 'pass' : 'fail'}">
                    <div class="result-icon">${passed ? 'üéâ' : 'üìö'}</div>
                    <div class="result-title">${passed ? 'Congratulations!' : 'Additional Study Required'}</div>
                    <div class="result-score">${score}%</div>
                    <div class="result-message">
                        <strong>${userData.name}</strong> (${userData.employeeId})<br>
                        <strong>Module:</strong> ${moduleNames[selectedModule]}<br>
                        <strong>Attempt:</strong> #${attemptNumber}<br><br>
                        ${passed ? 
                            `‚úÖ You have successfully passed the ${moduleNames[selectedModule]} assessment!<br>
                            You answered ${correctAnswers} out of 20 questions correctly.<br><br>
                            Your completion certificate is ready to download below.` :
                            `‚ùå You scored ${score}% but need 80% to pass (16/20 correct).<br>
                            You answered ${correctAnswers} out of 20 questions correctly.<br><br>
                            Please review the training materials and retake the assessment.`
                        }
                    </div>
                    
                    ${passed ? 
                        `<button class="btn btn-secondary" onclick="downloadCertificate()" style="margin-top: 25px;">üìÑ Download Certificate</button>` :
                        `<button class="btn" onclick="location.reload()" style="margin-top: 25px;">üîÑ Retake Assessment</button>`
                    }
                    <button class="btn btn-secondary" onclick="location.reload()" style="margin-top: 25px;">üè† Back to Home</button>
                </div>
            `;

            showSection('resultsSection');
        }

        function downloadCertificate() {
            const moduleNames = {
                'code-conduct': 'CODE OF CONDUCT',
                'data-privacy': 'DATA PRIVACY (GDPR + DPDP)',
                'isms': 'INFORMATION SECURITY MANAGEMENT (ISMS)',
                'posh': 'PREVENTION OF SEXUAL HARASSMENT (POSH)'
            };
            
            const allAttempts = JSON.parse(localStorage.getItem('complianceAttempts') || '[]');
            const userAttempts = allAttempts.filter(a => 
                a.employeeId === userData.employeeId && 
                a.module === selectedModule
            );
            const latestAttempt = userAttempts[userAttempts.length - 1];
            
            const certId = `VYS-${selectedModule.toUpperCase()}-${userData.employeeId}-${Date.now()}`;
            
            const certificateHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Vyastics Certificate - ${userData.name}</title>
    <style>
        @page { margin: 0; }
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            margin: 0;
            padding: 50px;
            background: white;
        }
        .certificate {
            max-width: 800px;
            margin: 0 auto;
            padding: 60px;
            border: 15px solid #1C7293;
            border-radius: 20px;
            text-align: center;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        .company-name {
            font-size: 64px;
            font-weight: bold;
            color: #21295C;
            letter-spacing: 8px;
            margin-bottom: 10px;
        }
        h1 {
            font-size: 42px;
            color: #065A82;
            margin: 30px 0;
            font-weight: normal;
            letter-spacing: 2px;
        }
        .subtitle {
            font-size: 20px;
            color: #666;
            margin: 20px 0;
            font-style: italic;
        }
        .employee-name {
            font-size: 48px;
            color: #21295C;
            font-weight: bold;
            margin: 30px 0;
            padding: 20px;
            background: #E8F4F8;
            border-radius: 10px;
        }
        .details {
            font-size: 18px;
            color: #444;
            line-height: 2;
            margin: 30px 0;
        }
        .module-name {
            font-size: 32px;
            color: #1C7293;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            background: #D4EDF6;
            border-radius: 10px;
        }
        .score-box {
            display: inline-block;
            padding: 20px 40px;
            background: #11998e;
            color: white;
            font-size: 36px;
            font-weight: bold;
            border-radius: 10px;
            margin: 20px 0;
        }
        .footer {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 3px solid #1C7293;
            font-size: 14px;
            color: #666;
        }
        .cert-id {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #999;
            margin-top: 20px;
        }
        .signature-line {
            margin: 40px auto 10px;
            width: 300px;
            border-top: 2px solid #333;
            padding-top: 10px;
            font-size: 16px;
            color: #333;
        }
        @media print {
            body { padding: 0; }
            .no-print { display: none; }
        }
    </style>
</head>
<body>
    <div class="certificate">
        <div class="company-name">VYASTICS</div>
        
        <h1>CERTIFICATE OF COMPLETION</h1>
        
        <div class="subtitle">This certifies that</div>
        
        <div class="employee-name">${userData.name}</div>
        
        <div class="details">
            Employee ID: <strong>${userData.employeeId}</strong><br>
            Department: <strong>${userData.department}</strong><br>
            Email: <strong>${userData.email}</strong>
        </div>
        
        <div class="subtitle">has successfully completed the</div>
        
        <div class="module-name">${moduleNames[selectedModule]}<br>TRAINING 2026</div>
        
        <div class="subtitle">with a score of</div>
        
        <div class="score-box">${latestAttempt.score}%</div>
        
        <div class="details" style="margin-top: 30px;">
            <strong>Assessment Details:</strong><br>
            Questions Answered: 20<br>
            Correct Answers: ${latestAttempt.correctAnswers}<br>
            Pass Requirement: 80% (16/20)<br>
            Attempt Number: ${latestAttempt.attempt}<br>
            Completion Date: ${new Date(latestAttempt.timestamp).toLocaleDateString('en-IN', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            })}
        </div>
        
        <div class="signature-line">
            Lakshmi<br>
            <strong>HR Manager, Vyastics</strong>
        </div>
        
        <div class="footer">
            This is an automatically generated certificate and serves as official proof of training completion.<br>
            Certificate ID: <span class="cert-id">${certId}</span><br><br>
            <strong>¬© 2026 Vyastics. All Rights Reserved.</strong>
        </div>
    </div>
    
    <div class="no-print" style="text-align: center; margin-top: 30px;">
        <button onclick="window.print()" style="padding: 15px 30px; font-size: 18px; background: #1C7293; color: white; border: none; border-radius: 8px; cursor: pointer;">
            üñ®Ô∏è Print / Save as PDF
        </button>
        <br><br>
        <p style="color: #666;">Use Ctrl+P or Cmd+P, then select "Save as PDF" to download</p>
    </div>
</body>
</html>
            `;
            
            const newWindow = window.open('', '_blank');
            newWindow.document.write(certificateHTML);
            newWindow.document.close();
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }
    </script>
</body>
</html>
